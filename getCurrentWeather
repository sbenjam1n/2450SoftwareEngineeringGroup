//Steven Benjamin - 2450 Team Project - Weather Get

var celcius;
var frnht;

var lon;
var lat;

var country="us";
var city;
var location;

var zip;

//Set usersChoice to true if user has supplied valid input that can be associated with a zip code.
var usersChoice;

$(document).ready(function getPosition() 
{

  //Get weather details based on approximate location if the user doesn't have a preference.
  if(usersChoice!==true)
  {
    
  // Find the longitude and latitude based on the users ip.
  var location = "http://ip-api.com/json";

  $.getJSON(location, function(json) 
  {

    lat = json.lat;
    lon = json.lon;

    //Get the weather data from the open weather API
    $.getJSON("http://api.openweathermap.org/data/2.5/weather?lat=" + lat + "&lon=" + lon +       "&APPID=ccd8e53c44061ba9fa3596d8aa75cc5e", function(json) 
    {
      
      var country = json.sys.country;
      var city = json.name;
      var location = city + ", " + country;

      //Let's see if that worked...
      console.log(city);
      console.log(country);
      console.log(location);
      
      var weather = json.weather[0].description;

      var temp = json.main.temp;
      celcius = Math.round((temp - 273.15));
      frnht = Math.round(celcius * 1.8 + 32);
      
      console.log(celcius);
      console.log(frnht);



    });
  });
  } //end if 
  
  
  //If we have a zip code...
  else
  {
    
    $.getJSON("http://api.openweathermap.org/data/2.5/weather?zip="+ zip +"," + country +"&APPID=ccd8e53c44061ba9fa3596d8aa75cc5e",function(json)
    {
      var country = json.sys.country;
      var city = json.name;
      var location = city + ", " + country;

      //Let's see if that worked...
      console.log(city);
      console.log(country);
      console.log(location);
      
      var weather = json.weather[0].description;

      var temp = json.main.temp;
      celcius = Math.round((temp - 273.15));
      frnht = Math.round(celcius * 1.8 + 32);
      
      console.log(celcius);
      console.log(frnht);        
              
    });
    
    
   }//end else

});
